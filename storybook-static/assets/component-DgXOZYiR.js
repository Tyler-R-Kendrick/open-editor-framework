import{j as g}from"./jsx-runtime-DlRdbTK2.js";import{a as z,R as y,r as l}from"./iframe-B_meevF9.js";import{b as A}from"./Icon-CM8U-gYh.js";var w={},D;function K(){if(D)return w;D=1,Object.defineProperty(w,"__esModule",{value:!0}),w.A4uZoomOut=b;var a=x(z());function x(r){return r&&r.__esModule?r:{default:r}}function c(){return c=Object.assign?Object.assign.bind():function(r){for(var i=1;i<arguments.length;i++){var h=arguments[i];for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(r[f]=h[f])}return r},c.apply(this,arguments)}function b(r){var i=c({},r);return a.default.createElement("svg",c({viewBox:"0 0 36 36"},i,i),a.default.createElement("rect",{fillRule:"evenodd",height:"4",rx:"0.5",ry:"0.5",width:"12",x:"10",y:"14"}),a.default.createElement("path",{fillRule:"evenodd",d:"M35.173,32.215,27.256,24.3A14.031,14.031,0,1,0,24.3,27.257l7.916,7.916a2.1,2.1,0,0,0,2.958-2.958ZM6,16A10,10,0,1,1,16,26,10,10,0,0,1,6,16Z"}))}return w}var N=K();function V(a){return y.createElement(A,a,y.createElement(N.A4uZoomOut,null))}var k={},j;function X(){if(j)return k;j=1,Object.defineProperty(k,"__esModule",{value:!0}),k.A4uZoomIn=b;var a=x(z());function x(r){return r&&r.__esModule?r:{default:r}}function c(){return c=Object.assign?Object.assign.bind():function(r){for(var i=1;i<arguments.length;i++){var h=arguments[i];for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(r[f]=h[f])}return r},c.apply(this,arguments)}function b(r){var i=c({},r);return a.default.createElement("svg",c({viewBox:"0 0 36 36"},i,i),a.default.createElement("path",{fillRule:"evenodd",d:"M21.5,14H18V10.5a.5.5,0,0,0-.5-.5h-3a.5.5,0,0,0-.5.5V14H10.5a.5.5,0,0,0-.5.5v3a.5.5,0,0,0,.5.5H14v3.5a.5.5,0,0,0,.5.5h3a.5.5,0,0,0,.5-.5V18h3.5a.5.5,0,0,0,.5-.5v-3A.5.5,0,0,0,21.5,14Z"}),a.default.createElement("path",{fillRule:"evenodd",d:"M35.173,32.215,27.256,24.3A14.031,14.031,0,1,0,24.3,27.257l7.916,7.916a2.1,2.1,0,0,0,2.958-2.958ZM6,16A10,10,0,1,1,16,26,10,10,0,0,1,6,16Z"}))}return k}var Y=X();function W(a){return y.createElement(A,a,y.createElement(Y.A4uZoomIn,null))}var C={},q;function U(){if(q)return C;q=1,Object.defineProperty(C,"__esModule",{value:!0}),C.A4uRefresh=b;var a=x(z());function x(r){return r&&r.__esModule?r:{default:r}}function c(){return c=Object.assign?Object.assign.bind():function(r){for(var i=1;i<arguments.length;i++){var h=arguments[i];for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(r[f]=h[f])}return r},c.apply(this,arguments)}function b(r){var i=c({},r);return a.default.createElement("svg",c({viewBox:"0 0 36 36"},i,i),a.default.createElement("path",{fillRule:"evenodd",d:"M32.67383,20H30.78027a1.21547,1.21547,0,0,0-1.16259.93774,11.44726,11.44726,0,0,1-19.11573,5.074l-.69238-.69251,3.95508-3.95495A.78548.78548,0,0,0,14,20.80371.80343.80343,0,0,0,13.24561,20H2.49609A.4996.4996,0,0,0,2,20.49585V31.24573A.80293.80293,0,0,0,2.80371,32a.78433.78433,0,0,0,.56055-.2356l3.61719-3.61706.356.3562a16.17057,16.17057,0,0,0,7.28321,4.33179A15.43018,15.43018,0,0,0,33.66455,21.16968.99566.99566,0,0,0,32.67383,20Z"}),a.default.createElement("path",{fillRule:"evenodd",d:"M33.19629,4a.78383.78383,0,0,0-.56055.2356L29.01855,7.85266l-.35595-.3562a16.17057,16.17057,0,0,0-7.28321-4.33179A15.43018,15.43018,0,0,0,2.33545,14.83032.99571.99571,0,0,0,3.32617,16H5.21973a1.21558,1.21558,0,0,0,1.16259-.93787A11.44729,11.44729,0,0,1,25.49805,9.98828l.69238.69251-3.95508,3.95483A.78568.78568,0,0,0,22,15.19617.80353.80353,0,0,0,22.75439,16H33.50391A.49976.49976,0,0,0,34,15.50415V4.75427A.80293.80293,0,0,0,33.19629,4Z"}))}return C}var G=U();function J(a){return y.createElement(A,a,y.createElement(G.A4uRefresh,null))}const Q=({theme:a,"aria-label":x})=>{const c=l.useRef(null),b=l.useRef(null),r=l.useRef(null),i=l.useRef(null),h=l.useRef(0),f=l.useRef(null),[u,m]=l.useState({zoom:1,pan:{x:0,y:0},selectedComponents:[],clipboard:[],history:[],historyIndex:-1}),[v,I]=l.useState([]),[S,E]=l.useState(!1),[R,Z]=l.useState(null),O=l.useCallback(()=>{const t=c.current,n=b.current;if(!t||!n)return;const e=t.getContext("2d");r.current=e;const o=()=>{const s=n.getBoundingClientRect(),d=window.devicePixelRatio||1;t.width=s.width*d,t.height=s.height*d,t.style.width=`${s.width}px`,t.style.height=`${s.height}px`,e&&e.scale(d,d)};o(),window.addEventListener("resize",o);const p=new ResizeObserver(o);return p.observe(n),()=>{window.removeEventListener("resize",o),p.disconnect()}},[]),T=l.useCallback(t=>{const n=r.current;if(!n)return;const{bounds:e}=t;switch(n.fillStyle=String(t.properties.backgroundColor??"#ffffff"),n.fillRect(e.x,e.y,e.width,e.height),n.strokeStyle=String(t.properties.borderColor??"#e2e8f0"),n.lineWidth=Number(t.properties.borderWidth??1),n.strokeRect(e.x,e.y,e.width,e.height),t.type){case"text":n.fillStyle=String(t.properties.color??"#000000"),n.font=`${Number(t.properties.fontSize??16)}px ${String(t.properties.fontFamily??"Arial")}`,n.fillText(String(t.properties.text??"Text Component"),e.x+10,e.y+e.height/2+6);break;case"button":n.fillStyle=String(t.properties.backgroundColor??"#3b82f6"),n.fillRect(e.x,e.y,e.width,e.height),n.fillStyle=String(t.properties.color??"#ffffff"),n.font=`${Number(t.properties.fontSize??14)}px ${String(t.properties.fontFamily??"Arial")}`,n.textAlign="center",n.fillText(String(t.properties.text??"Button"),e.x+e.width/2,e.y+e.height/2+4),n.textAlign="start";break;case"image":n.fillStyle="#f3f4f6",n.fillRect(e.x,e.y,e.width,e.height),n.strokeStyle="#d1d5db",n.strokeRect(e.x,e.y,e.width,e.height),n.fillStyle="#9ca3af",n.font="20px Arial",n.textAlign="center",n.fillText("ðŸ–¼ï¸",e.x+e.width/2,e.y+e.height/2+8),n.textAlign="start";break}if(u.selectedComponents.includes(t.id)){n.strokeStyle="#3b82f6",n.lineWidth=2,n.setLineDash([5,5]),n.strokeRect(e.x-2,e.y-2,e.width+4,e.height+4),n.setLineDash([]);const o=8;n.fillStyle="#3b82f6",n.fillRect(e.x-o/2,e.y-o/2,o,o),n.fillRect(e.x+e.width-o/2,e.y-o/2,o,o),n.fillRect(e.x-o/2,e.y+e.height-o/2,o,o),n.fillRect(e.x+e.width-o/2,e.y+e.height-o/2,o,o)}},[u.selectedComponents]),_=l.useCallback(()=>{const t=r.current,n=c.current;if(!t||!n)return;const{width:e,height:o}=n.getBoundingClientRect();t.clearRect(0,0,e,o),t.save(),t.translate(u.pan.x,u.pan.y),t.scale(u.zoom,u.zoom),t.strokeStyle=a==="dark"?"#374151":"#f1f5f9",t.lineWidth=1;const p=20;for(let s=0;s<e;s+=p)t.beginPath(),t.moveTo(s,0),t.lineTo(s,o),t.stroke();for(let s=0;s<o;s+=p)t.beginPath(),t.moveTo(0,s),t.lineTo(e,s),t.stroke();v.forEach(s=>{T(s)}),t.restore()},[u.pan,u.zoom,v,T,a]),M=l.useCallback(t=>{switch(t.key){case"Delete":case"Backspace":I(n=>n.filter(e=>!u.selectedComponents.includes(e.id))),m(n=>({...n,selectedComponents:[]}));break;case"Escape":m(n=>({...n,selectedComponents:[]}));break;case"a":(t.ctrlKey||t.metaKey)&&(t.preventDefault(),m(n=>({...n,selectedComponents:v.map(e=>e.id)})));break}},[u.selectedComponents,v]),$=l.useCallback(t=>{const n=c.current;if(!n)return;const e=n.getBoundingClientRect(),o=(t.clientX-e.left-u.pan.x)/u.zoom,p=(t.clientY-e.top-u.pan.y)/u.zoom,s=v.find(d=>o>=d.bounds.x&&o<=d.bounds.x+d.bounds.width&&p>=d.bounds.y&&p<=d.bounds.y+d.bounds.height);s?(m(d=>({...d,selectedComponents:t.shiftKey?[...d.selectedComponents,s.id]:[s.id]})),E(!0)):m(d=>({...d,selectedComponents:[]}))},[u.pan,u.zoom,v]),L=l.useCallback(t=>{},[S]),P=l.useCallback(()=>{E(!1)},[]),B=l.useCallback(t=>{if(h.current=Date.now(),t.touches.length===2){const n=t.touches[0],e=t.touches[1],o=Math.sqrt(Math.pow(e.clientX-n.clientX,2)+Math.pow(e.clientY-n.clientY,2));Z({startDistance:o,startZoom:u.zoom})}f.current=window.setTimeout(()=>{"vibrate"in navigator&&navigator.vibrate(50)},500)},[u.zoom]),H=l.useCallback(t=>{if(t.preventDefault(),t.touches.length===2&&R?.startDistance!==void 0&&R?.startZoom!==void 0){const n=t.touches[0],e=t.touches[1],p=Math.sqrt(Math.pow(e.clientX-n.clientX,2)+Math.pow(e.clientY-n.clientY,2))/R.startDistance,s=Math.max(.1,Math.min(5,R.startZoom*p));m(d=>({...d,zoom:s}))}else if(t.touches.length===1){const n=c.current;if(!n)return;n.getBoundingClientRect()}},[R]),F=l.useCallback(()=>{f.current&&clearTimeout(f.current),Z(null)},[]);return l.useEffect(()=>{const t=O();return(()=>{const e=()=>{_(),i.current=requestAnimationFrame(e)};e()})(),()=>{i.current&&cancelAnimationFrame(i.current),t?.()}},[O,_]),l.useEffect(()=>(window.addEventListener("keydown",M),()=>{window.removeEventListener("keydown",M)}),[M]),g.jsxs("div",{ref:b,className:"canvas-container",style:{width:"100%",height:"100%",position:"relative",overflow:"hidden",background:a==="dark"?"#1e293b":"#f8fafc",cursor:S?"grabbing":"grab"},role:"img","aria-label":x||"Design Canvas",children:[g.jsx("canvas",{ref:c,onMouseDown:$,onMouseMove:L,onMouseUp:P,onTouchStart:B,onTouchMove:H,onTouchEnd:F,style:{display:"block",touchAction:"none",userSelect:"none"},"aria-label":"Interactive design canvas"}),g.jsxs("div",{style:{position:"absolute",bottom:"16px",right:"16px",display:"flex",gap:"8px",background:a==="dark"?"#374151":"white",borderRadius:"8px",padding:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[g.jsx("button",{onClick:()=>m(t=>({...t,zoom:Math.max(.1,t.zoom-.1)})),style:{padding:"8px 12px",border:"none",borderRadius:"4px",background:a==="dark"?"#4b5563":"#f3f4f6",color:a==="dark"?"#f8fafc":"#1e293b",cursor:"pointer"},"aria-label":"Zoom out",children:g.jsx(V,{"aria-hidden":"true",size:"S"})}),g.jsxs("span",{style:{padding:"8px 12px",color:a==="dark"?"#f8fafc":"#1e293b",fontSize:"14px"},children:[Math.round(u.zoom*100),"%"]}),g.jsx("button",{onClick:()=>m(t=>({...t,zoom:Math.min(5,t.zoom+.1)})),style:{padding:"8px 12px",border:"none",borderRadius:"4px",background:a==="dark"?"#4b5563":"#f3f4f6",color:a==="dark"?"#f8fafc":"#1e293b",cursor:"pointer"},"aria-label":"Zoom in",children:g.jsx(W,{"aria-hidden":"true",size:"S"})}),g.jsx("button",{onClick:()=>m(t=>({...t,zoom:1,pan:{x:0,y:0}})),style:{padding:"8px 12px",border:"none",borderRadius:"4px",background:a==="dark"?"#4b5563":"#f3f4f6",color:a==="dark"?"#f8fafc":"#1e293b",cursor:"pointer"},"aria-label":"Reset zoom and pan",children:g.jsx(J,{"aria-hidden":"true",size:"S"})})]})]})};Q.__docgenInfo={description:`HTML5 Canvas-based editor panel with touch and accessibility support
Features:
- Touch-optimized interactions (pan, zoom, tap, long press)
- Keyboard accessibility and shortcuts
- Component selection and manipulation
- Canvas rendering with zoom/pan
- Multi-touch gesture support`,methods:[],displayName:"EditorCanvas",props:{theme:{required:!0,tsType:{name:"union",raw:"'light' | 'dark'",elements:[{name:"literal",value:"'light'"},{name:"literal",value:"'dark'"}]},description:""},"aria-label":{required:!1,tsType:{name:"string"},description:""}}};export{Q as E};
